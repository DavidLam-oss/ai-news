# 飞书应用权限配置指南

## 📋 概述

本指南将帮助你为AI早报系统的飞书应用配置必要的权限，以便能够正常访问和操作多维表格。

## 🔑 当前应用信息

- **应用ID**: `cli_a8366b7ef13a100c`
- **应用名称**: AI早报系统
- **应用类型**: 企业自建应用

## 🚀 快速配置（推荐）

### 方法一：一键申请权限

点击以下链接直接申请所有必需权限：

```
https://open.feishu.cn/app/cli_a8366b7ef13a100c/auth?q=bitable:app:readonly,bitable:app,base:app:read,base:table:read,base:record:retrieve&op_from=openapi&token_type=tenant
```

### 方法二：手动配置

1. 登录[飞书开放平台](https://open.feishu.cn/)
2. 进入应用管理后台
3. 选择你的应用 `cli_a8366b7ef13a100c`
4. 点击"权限管理"
5. 按照下面的权限列表逐一添加

## 📝 必需权限列表

### 1. 多维表格应用权限

| 权限名称 | 权限标识 | 权限描述 | 必需性 |
|---------|---------|---------|--------|
| 多维表格应用只读权限 | `bitable:app:readonly` | 读取多维表格应用信息 | ✅ 必需 |
| 多维表格应用权限 | `bitable:app` | 完整的多维表格应用权限 | ✅ 必需 |

### 2. 基础应用权限

| 权限名称 | 权限标识 | 权限描述 | 必需性 |
|---------|---------|---------|--------|
| 基础应用读取权限 | `base:app:read` | 读取基础应用信息 | ✅ 必需 |

### 3. 表格操作权限

| 权限名称 | 权限标识 | 权限描述 | 必需性 |
|---------|---------|---------|--------|
| 基础表格读取权限 | `base:table:read` | 读取表格结构和信息 | ✅ 必需 |
| 基础记录检索权限 | `base:record:retrieve` | 检索表格记录 | ✅ 必需 |
| 基础记录创建权限 | `base:record:create` | 创建新记录 | ✅ 必需 |
| 基础记录更新权限 | `base:record:update` | 更新现有记录 | ✅ 必需 |

### 4. 可选权限（推荐）

| 权限名称 | 权限标识 | 权限描述 | 必需性 |
|---------|---------|---------|--------|
| 基础记录删除权限 | `base:record:delete` | 删除记录 | 🔶 可选 |
| 基础字段读取权限 | `base:field:read` | 读取字段信息 | 🔶 可选 |
| 基础字段创建权限 | `base:field:create` | 创建新字段 | 🔶 可选 |

## 🔧 详细配置步骤

### 步骤1：登录飞书开放平台

1. 访问 [https://open.feishu.cn/](https://open.feishu.cn/)
2. 使用你的飞书账号登录
3. 进入开发者后台

### 步骤2：选择应用

1. 在应用列表中找到 `cli_a8366b7ef13a100c`
2. 点击应用名称进入应用详情页

### 步骤3：进入权限管理

1. 在左侧菜单中点击"权限管理"
2. 点击"申请权限"按钮

### 步骤4：添加权限

1. 在权限搜索框中输入权限标识（如 `bitable:app:readonly`）
2. 找到对应权限并点击"申请"
3. 重复此步骤添加所有必需权限

### 步骤5：创建新版本

1. 权限添加完成后，点击"版本管理与发布"
2. 点击"创建新版本"
3. 填写版本信息：
   - 版本号：`v1.0.0`
   - 更新说明：`添加多维表格访问权限`
4. 点击"保存"

### 步骤6：发布应用

1. 在版本列表中找到刚创建的版本
2. 点击"申请发布"
3. 选择可见范围（建议选择"企业内全部成员"）
4. 提交申请

### 步骤7：等待审核

1. 企业管理员会收到审核通知
2. 管理员审核通过后，应用即可正常使用
3. 审核时间通常为几分钟到几小时

## 🧪 权限配置验证

配置完成后，运行以下命令验证权限：

```bash
# 测试飞书配置
python3 test_feishu_tokens.py

# 测试完整功能
python3 test_feishu_config.py
```

## ❌ 常见问题解决

### 问题1：权限申请被拒绝

**原因**: 企业管理员可能不了解应用用途
**解决方案**: 
1. 联系企业管理员说明应用用途
2. 提供应用功能说明文档
3. 申请最小必要权限

### 问题2：权限添加后仍无法访问

**原因**: 应用版本未发布或审核未通过
**解决方案**:
1. 检查应用版本状态
2. 确认管理员已审核通过
3. 等待权限生效（通常需要几分钟）

### 问题3：部分功能仍无法使用

**原因**: 缺少特定权限
**解决方案**:
1. 查看错误日志中的权限要求
2. 添加缺失的权限
3. 重新发布应用版本

## 📞 技术支持

如果遇到问题，可以：

1. 查看[飞书开放平台文档](https://open.feishu.cn/document/)
2. 联系飞书技术支持
3. 查看应用日志获取详细错误信息

## 🔄 权限更新流程

当需要添加新权限时：

1. 在权限管理中申请新权限
2. 创建新版本并发布
3. 等待管理员审核
4. 测试新功能

## 📋 权限检查清单

- [ ] `bitable:app:readonly` - 多维表格应用只读权限
- [ ] `bitable:app` - 多维表格应用权限
- [ ] `base:app:read` - 基础应用读取权限
- [ ] `base:table:read` - 基础表格读取权限
- [ ] `base:record:retrieve` - 基础记录检索权限
- [ ] `base:record:create` - 基础记录创建权限
- [ ] `base:record:update` - 基础记录更新权限
- [ ] 应用版本已发布
- [ ] 管理员审核已通过
- [ ] 权限测试通过

## 🎯 下一步

权限配置完成后，你可以：

1. 运行完整的系统测试
2. 开始使用AI早报功能
3. 配置自动化工作流
4. 设置定时任务

---

**注意**: 请确保在配置权限时遵循最小权限原则，只申请应用实际需要的权限，以保障数据安全。
